<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Custom Logo</title>
    <style>
        .logo-preview {
            max-width: 200px;
            max-height: 100px;
            margin: 10px 0;
            border: 1px solid #444;
            border-radius: 4px;
            background: #1c1c1e;
            padding: 10px;
        }
        .logo-section {
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
        }
        .delete-btn {
            background: #c62828 !important;
            margin-left: 10px;
        }
        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85em;
            margin-left: 10px;
        }
        .status-active {
            background: #2e7d32;
            color: white;
        }
        .status-inactive {
            background: #666;
            color: white;
        }
        .info-box {
            background: rgba(0, 150, 136, 0.1);
            border-left: 4px solid #009688;
            padding: 12px;
            margin-bottom: 20px;
            border-radius: 4px;
        }
    </style>
</head>
<hr>
<body>
    <div id="TemplateConfigPage" data-role="page" class="page type-interior pluginConfigurationPage" data-require="emby-input,emby-button,emby-select,emby-checkbox">
        <div data-role="content">
            <div class="content-primary">
                <h1>Custom Logo</h1>

                <div class="info-box">
                    <strong>How it works:</strong> When Jellyfin (or any app) requests a logo, this plugin serves your custom logo instead. No additional configuration needed!
                    <br><br>
                    <strong>Note:</strong> After uploading, you may need to clear your browser cache or do a hard refresh (Ctrl+F5) to see the changes. Mobile apps may require a restart.
                </div>

                <form id="TemplateConfigForm" method="POST" action="/logo/upload" enctype="multipart/form-data">
                    <div class="logo-section">
                        <h2>Logo Icon <span id="iconStatus" class="status-badge status-inactive">Not set</span></h2>
                        <p>The small icon shown in the header and various places.</p>
                        <img id="iconPreview" class="logo-preview" style="display:none;" />
                        <div class="inputContainer">
                            <label class="inputLabel inputLabelUnfocused" for="Logo">Upload your custom logo (PNG)</label>
                            <input id="Logo" name="Logo" type="file" accept="image/png" is="emby-input" />
                        </div>
                        <button type="button" id="deleteIcon" class="raised button-submit emby-button delete-btn" style="display:none;">
                            <span>Delete Icon</span>
                        </button>
                    </div>

                    <div class="logo-section">
                        <h2>Banner Dark <span id="bannerDarkStatus" class="status-badge status-inactive">Not set</span></h2>
                        <p>The banner shown on the login page (dark mode).</p>
                        <img id="bannerDarkPreview" class="logo-preview" style="display:none;" />
                        <div class="inputContainer">
                            <label class="inputLabel inputLabelUnfocused" for="BannerDark">Upload dark mode banner (PNG)</label>
                            <input id="BannerDark" name="BannerDark" type="file" accept="image/png" is="emby-input" />
                        </div>
                        <button type="button" id="deleteBannerDark" class="raised button-submit emby-button delete-btn" style="display:none;">
                            <span>Delete Banner Dark</span>
                        </button>
                    </div>

                    <div class="logo-section">
                        <h2>Banner Light <span id="bannerLightStatus" class="status-badge status-inactive">Not set</span></h2>
                        <p>The banner shown on the login page (light mode).</p>
                        <img id="bannerLightPreview" class="logo-preview" style="display:none;" />
                        <div class="inputContainer">
                            <label class="inputLabel inputLabelUnfocused" for="BannerLight">Upload light mode banner (PNG)</label>
                            <input id="BannerLight" name="BannerLight" type="file" accept="image/png" is="emby-input" />
                        </div>
                        <button type="button" id="deleteBannerLight" class="raised button-submit emby-button delete-btn" style="display:none;">
                            <span>Delete Banner Light</span>
                        </button>
                    </div>

                    <div>
                        <button is="emby-button" type="submit" class="raised button-submit block emby-button">
                            <span>Save</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            checkLogo('/logo/icon', 'iconPreview', 'iconStatus', 'deleteIcon');
            checkLogo('/logo/banner-dark', 'bannerDarkPreview', 'bannerDarkStatus', 'deleteBannerDark');
            checkLogo('/logo/banner-light', 'bannerLightPreview', 'bannerLightStatus', 'deleteBannerLight');

            document.getElementById('deleteIcon').addEventListener('click', () => deleteLogo('/logo/icon', 'iconPreview', 'iconStatus', 'deleteIcon'));
            document.getElementById('deleteBannerDark').addEventListener('click', () => deleteLogo('/logo/banner-dark', 'bannerDarkPreview', 'bannerDarkStatus', 'deleteBannerDark'));
            document.getElementById('deleteBannerLight').addEventListener('click', () => deleteLogo('/logo/banner-light', 'bannerLightPreview', 'bannerLightStatus', 'deleteBannerLight'));
        });

        function checkLogo(url, previewId, statusId, deleteId) {
            fetch(url)
                .then(response => {
                    if (response.ok) {
                        document.getElementById(previewId).src = url + '?t=' + Date.now();
                        document.getElementById(previewId).style.display = 'block';
                        document.getElementById(statusId).textContent = 'Active';
                        document.getElementById(statusId).className = 'status-badge status-active';
                        document.getElementById(deleteId).style.display = 'inline-block';
                    }
                })
                .catch(() => {});
        }

        function deleteLogo(url, previewId, statusId, deleteId) {
            if (confirm('Are you sure you want to delete this logo?')) {
                fetch(url, { method: 'DELETE' })
                    .then(response => {
                        if (response.ok) {
                            document.getElementById(previewId).style.display = 'none';
                            document.getElementById(statusId).textContent = 'Not set';
                            document.getElementById(statusId).className = 'status-badge status-inactive';
                            document.getElementById(deleteId).style.display = 'none';
                        }
                    })
                    .catch(err => alert('Error deleting logo: ' + err));
            }
        }
    </script>
</body>
</html>
